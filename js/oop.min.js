var OOP={class:function(){var t,e=Object;arguments.length>=2?(e=arguments[0]||Object,t=arguments[1]):t=arguments[0];var i=function(){this.base()},n=[];t.prototype.constructor=function(t){i=t},t.prototype.variable=function(t,e){n.push({name:t,static:!1,type:"variable",value:e})},t.prototype.property=function(t,e){n.push({name:t,static:!1,type:"property",value:e})},t.prototype.method=function(t,e){n.push({name:t,static:!1,type:"method",value:e})},t.prototype.event=function(t,e){void 0===e&&(e=OOP.EventListener),n.push({name:t,static:!1,type:"event",class:e})},t.prototype.staticVariable=function(t,e){n.push({name:t,static:!0,type:"variable",value:e})},t.prototype.staticProperty=function(t,e){n.push({name:t,static:!0,type:"property",value:e})},t.prototype.staticMethod=function(t,e){n.push({name:t,static:!0,type:"method",value:e})},new t;var r=!1,s=function(){var t=this.__this;for(var o in this.__static&&(a=this.__static),delete this.__proto__.__this,delete this.__proto__.__static,this.result={},this.result.__this=this,Object.defineProperty(this.result,"self",{get:function(){return s.self}}),Object.defineProperty(this.result,"static",{get:function(){return s.static}}),Object.defineProperty(this.result,"parent",{get:function(){return s.parent}}),this.declaration={},n){var c=n[o];if(!c.static)switch(c.type){case"event":this.declaration[c.name]=new c.class;break;case"variable":this.declaration[c.name]=c.value;break;case"property":Object.defineProperty(this.declaration,c.name,c.value);break;case"method":this.declaration[c.name]=c.value.bind(this.result)}}if(this.topDeclaration=null==t?this.declaration:t.__this.topDeclaration,null!=t&&(t.__this.declaration.__proto__=this.declaration,t.__this.rebindDeclarations()),this.result.base=function(){var t,i=Array.from(arguments);return i.unshift(this),e==Object?t=new e:(e.prototype.__this=this,e.prototype.__static=s.static,t=new(Function.prototype.bind.apply(e,i))),r=!0,t},null!=t&&(t.__this.result.base.__proto__=this.declaration),this.bindDeclarations=function(){for(var t=[],e=this.topDeclaration;e!=Object.prototype;){for(var i=Object.getOwnPropertyNames(e),n=0;n<i.length;n++){var r=i[n];t.includes(r)||(t.push(r),function(t,e){var i={configurable:!0,get:function(){return t[e]},set:function(i){t[e]=i}},n=Object.getOwnPropertyDescriptor(t,e);n.hasOwnProperty("get")&&(i.get=n.get),n.hasOwnProperty("set")&&(i.set=n.set),Object.defineProperty(this.result,e,i)}.bind(this)(e,r))}e=e.__proto__}},this.rebindDeclarations=function(){null!=t&&t.__this.rebindDeclarations(),this.bindDeclarations()},this.rebindDeclarations(),i.apply(this.result,arguments),!r)throw new Error("this.base must be called inside constructor");return this.result},a=s;for(var o in s.__proto__=e,Object.defineProperty(s,"self",{get:function(){return this}}),Object.defineProperty(s,"static",{get:function(){return a}}),Object.defineProperty(s,"parent",{get:function(){return e}}),n){var c=n[o];if(c.static)switch(c.type){case"variable":s[c.name]=c.value;break;case"property":Object.defineProperty(s,c.name,c.value);break;case"method":s[c.name]=c.value.bind(s)}}return s}};OOP.Event=OOP.class(function(){this.variable("_arguments"),this.variable("_isPropagationStopped",!1),this.constructor(function(arguments){this.base(),this._arguments=arguments}),this.property("arguments",{get:function(){return this._arguments}}),this.method("stopPropagation",function(){this._isPropagationStopped=!0}),this.method("isPropagationStopped",function(){return this._isPropagationStopped})}),OOP.EventListener=OOP.class(function(){this.variable("_eventListeners"),this.constructor(function(){this.base(),this._eventListeners=[]}),this.method("invoke",function(t,arguments){var e=this._getInvokeEvent(arguments);for(var i in this._eventListeners){var n=this._eventListeners[i];if(!e.isPropagationStopped)break;Object.bind.apply(n,[t])(e)}return e}),this.method("_getInvokeEvent",function(arguments){return new OOP.Event(arguments)}),this.method("getEventListners",function(){return this._eventListeners}),this.method("addEventListener",function(t){return-1===this._eventListeners.indexOf(t)&&(this._eventListeners.push(t),!0)}),this.method("removeEventListener",function(t){var e=this._eventListeners.indexOf(t);return-1!==e&&(this._eventListeners=this._eventListeners.splice(e,1),!0)})});